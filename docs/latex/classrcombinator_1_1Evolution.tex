\hypertarget{classrcombinator_1_1Evolution}{}\section{rcombinator\+:\+:Evolution Class Reference}
\label{classrcombinator_1_1Evolution}\index{rcombinator\+::\+Evolution@{rcombinator\+::\+Evolution}}


An interface for simulating the evolution of sequences.  




{\ttfamily \#include $<$evolution.\+h$>$}



Inheritance diagram for rcombinator\+:\+:Evolution\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classrcombinator_1_1Evolution__inherit__graph}
\end{center}
\end{figure}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classrcombinator_1_1Evolution_a6ed5af2795fb3bae514a5de924969db4}\label{classrcombinator_1_1Evolution_a6ed5af2795fb3bae514a5de924969db4}} 
typedef \mbox{\hyperlink{classrcombinator_1_1Family_abe1bd4ecd0792a403e9a4af26b8e5156}{Family\+::seqs\+\_\+type}} \mbox{\hyperlink{classrcombinator_1_1Evolution_a6ed5af2795fb3bae514a5de924969db4}{seqs\+\_\+type}}
\begin{DoxyCompactList}\small\item\em Borrow typedef from family. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classrcombinator_1_1Evolution_a0aa94cf8dd5f6184535faf82842337fd}{Evolution}} (\mbox{\hyperlink{constants_8h_abcd18a5521fc90ff6e7b00e4fee98397}{size\+\_\+type}} \mbox{\hyperlink{classrcombinator_1_1Evolution_a9e4feea87909393e38280bf12c9ef2fc}{num\+\_\+jumps}}, double \mbox{\hyperlink{classrcombinator_1_1Evolution_a4199e62af41c1d4131547a0fa1eaedbe}{timestep}}, double \mbox{\hyperlink{classrcombinator_1_1Evolution_aabe7c0fa6f08d6b891762957770efafe}{burst\+\_\+probability}}, double \mbox{\hyperlink{classrcombinator_1_1Evolution_aaf24044a7c370487557c55e5c12fe1e5}{burst\+\_\+mean}}, \mbox{\hyperlink{constants_8h_abcd18a5521fc90ff6e7b00e4fee98397}{size\+\_\+type}} \mbox{\hyperlink{classrcombinator_1_1Evolution_a8a542398bf9a3a7d42623d4d090a6e96}{max\+\_\+active\+\_\+copies}})
\begin{DoxyCompactList}\small\item\em Set up a simulation with given parameters. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classrcombinator_1_1Evolution_a0b8a181242ea8ee3072258fa7ed416f4}{evolve}} (\mbox{\hyperlink{classrcombinator_1_1Output}{Output}} \&output, \mbox{\hyperlink{classrcombinator_1_1PointMutator}{Point\+Mutator}} \&pm, const std\+::vector$<$ std\+::string $>$ \&init\+\_\+seqs, double recomb\+\_\+mean)
\begin{DoxyCompactList}\small\item\em Run a simulation, modify the sequences, and output results to file. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classrcombinator_1_1Evolution_af59e41c84713f8956d3e4eb1691a1b38}\label{classrcombinator_1_1Evolution_af59e41c84713f8956d3e4eb1691a1b38}} 
virtual \mbox{\hyperlink{classrcombinator_1_1Evolution_af59e41c84713f8956d3e4eb1691a1b38}{$\sim$\+Evolution}} ()=default
\begin{DoxyCompactList}\small\item\em Use a virtual destructor so objects can be instantiated. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \mbox{\hyperlink{classrcombinator_1_1Evolution_ad4af177c458f2d6add719e64c534761a}{burst\+\_\+seqs}} (const \mbox{\hyperlink{constants_8h_abcd18a5521fc90ff6e7b00e4fee98397}{size\+\_\+type}} t, const double recomb\+\_\+mean)=0
\begin{DoxyCompactList}\small\item\em How the sequences burst after a timestep in the simulation. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classrcombinator_1_1Evolution_a9e4feea87909393e38280bf12c9ef2fc}\label{classrcombinator_1_1Evolution_a9e4feea87909393e38280bf12c9ef2fc}} 
const \mbox{\hyperlink{constants_8h_abcd18a5521fc90ff6e7b00e4fee98397}{size\+\_\+type}} \mbox{\hyperlink{classrcombinator_1_1Evolution_a9e4feea87909393e38280bf12c9ef2fc}{num\+\_\+jumps}}
\begin{DoxyCompactList}\small\item\em Number of jumps in our simulation. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classrcombinator_1_1Evolution_a4199e62af41c1d4131547a0fa1eaedbe}\label{classrcombinator_1_1Evolution_a4199e62af41c1d4131547a0fa1eaedbe}} 
const double \mbox{\hyperlink{classrcombinator_1_1Evolution_a4199e62af41c1d4131547a0fa1eaedbe}{timestep}}
\begin{DoxyCompactList}\small\item\em How much time has passed in one jump (in millions of years) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classrcombinator_1_1Evolution_aabe7c0fa6f08d6b891762957770efafe}\label{classrcombinator_1_1Evolution_aabe7c0fa6f08d6b891762957770efafe}} 
const double \mbox{\hyperlink{classrcombinator_1_1Evolution_aabe7c0fa6f08d6b891762957770efafe}{burst\+\_\+probability}}
\begin{DoxyCompactList}\small\item\em Probability that an active sequence bursts in {\itshape timestep}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classrcombinator_1_1Evolution_aaf24044a7c370487557c55e5c12fe1e5}\label{classrcombinator_1_1Evolution_aaf24044a7c370487557c55e5c12fe1e5}} 
const double \mbox{\hyperlink{classrcombinator_1_1Evolution_aaf24044a7c370487557c55e5c12fe1e5}{burst\+\_\+mean}}
\begin{DoxyCompactList}\small\item\em The Poisson mean for new number of sequences to be created. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classrcombinator_1_1Evolution_a8a542398bf9a3a7d42623d4d090a6e96}\label{classrcombinator_1_1Evolution_a8a542398bf9a3a7d42623d4d090a6e96}} 
const \mbox{\hyperlink{constants_8h_abcd18a5521fc90ff6e7b00e4fee98397}{size\+\_\+type}} \mbox{\hyperlink{classrcombinator_1_1Evolution_a8a542398bf9a3a7d42623d4d090a6e96}{max\+\_\+active\+\_\+copies}}
\begin{DoxyCompactList}\small\item\em The total number of sequences that have the ability to burst we allow in our simulation. \end{DoxyCompactList}\item 
std\+::list$<$ \mbox{\hyperlink{classrcombinator_1_1Family}{Family}} $>$ \mbox{\hyperlink{classrcombinator_1_1Evolution_a32a114f62cd6b0f075b8dc47fe86514e}{families}}
\begin{DoxyCompactList}\small\item\em The actual values of the sequences during the simulation. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classrcombinator_1_1Evolution_ad0556b6be2ae850c2e3627627412c8f9}\label{classrcombinator_1_1Evolution_ad0556b6be2ae850c2e3627627412c8f9}} 
\mbox{\hyperlink{constants_8h_abcd18a5521fc90ff6e7b00e4fee98397}{size\+\_\+type}} \mbox{\hyperlink{classrcombinator_1_1Evolution_ad0556b6be2ae850c2e3627627412c8f9}{total\+\_\+num\+\_\+sequences}}
\begin{DoxyCompactList}\small\item\em The overall number of sequences across all families. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
An interface for simulating the evolution of sequences. 

Provides basic functionality, all subclasses specialise some methods provided by this class to add events/flags/copy trees etc. 

\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classrcombinator_1_1Evolution_a0aa94cf8dd5f6184535faf82842337fd}\label{classrcombinator_1_1Evolution_a0aa94cf8dd5f6184535faf82842337fd}} 
\index{rcombinator\+::\+Evolution@{rcombinator\+::\+Evolution}!Evolution@{Evolution}}
\index{Evolution@{Evolution}!rcombinator\+::\+Evolution@{rcombinator\+::\+Evolution}}
\subsubsection{\texorpdfstring{Evolution()}{Evolution()}}
{\footnotesize\ttfamily Evolution\+::\+Evolution (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{constants_8h_abcd18a5521fc90ff6e7b00e4fee98397}{size\+\_\+type}}}]{num\+\_\+jumps,  }\item[{double}]{timestep,  }\item[{double}]{burst\+\_\+probability,  }\item[{double}]{burst\+\_\+mean,  }\item[{\mbox{\hyperlink{constants_8h_abcd18a5521fc90ff6e7b00e4fee98397}{size\+\_\+type}}}]{max\+\_\+active\+\_\+copies }\end{DoxyParamCaption})}



Set up a simulation with given parameters. 

Look at documenation for the individual members to understand what they mean. 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{classrcombinator_1_1Evolution_ad4af177c458f2d6add719e64c534761a}\label{classrcombinator_1_1Evolution_ad4af177c458f2d6add719e64c534761a}} 
\index{rcombinator\+::\+Evolution@{rcombinator\+::\+Evolution}!burst\+\_\+seqs@{burst\+\_\+seqs}}
\index{burst\+\_\+seqs@{burst\+\_\+seqs}!rcombinator\+::\+Evolution@{rcombinator\+::\+Evolution}}
\subsubsection{\texorpdfstring{burst\+\_\+seqs()}{burst\_seqs()}}
{\footnotesize\ttfamily virtual void rcombinator\+::\+Evolution\+::burst\+\_\+seqs (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{constants_8h_abcd18a5521fc90ff6e7b00e4fee98397}{size\+\_\+type}}}]{t,  }\item[{const double}]{recomb\+\_\+mean }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [pure virtual]}}



How the sequences burst after a timestep in the simulation. 

To be implemented by a derived class, depending on our assumptions. 

Implemented in \mbox{\hyperlink{classrcombinator_1_1EvolutionWithoutFlags_aeba3cc75049e0590e5dcaab9558f8c56}{rcombinator\+::\+Evolution\+Without\+Flags}}, and \mbox{\hyperlink{classrcombinator_1_1EvolutionWithFlags_abad180fa8494b259e5167a13285347dd}{rcombinator\+::\+Evolution\+With\+Flags}}.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classrcombinator_1_1Evolution_ad4af177c458f2d6add719e64c534761a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classrcombinator_1_1Evolution_a0b8a181242ea8ee3072258fa7ed416f4}\label{classrcombinator_1_1Evolution_a0b8a181242ea8ee3072258fa7ed416f4}} 
\index{rcombinator\+::\+Evolution@{rcombinator\+::\+Evolution}!evolve@{evolve}}
\index{evolve@{evolve}!rcombinator\+::\+Evolution@{rcombinator\+::\+Evolution}}
\subsubsection{\texorpdfstring{evolve()}{evolve()}}
{\footnotesize\ttfamily void Evolution\+::evolve (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classrcombinator_1_1Output}{Output}} \&}]{output,  }\item[{\mbox{\hyperlink{classrcombinator_1_1PointMutator}{Point\+Mutator}} \&}]{pm,  }\item[{const std\+::vector$<$ std\+::string $>$ \&}]{init\+\_\+seqs,  }\item[{double}]{recomb\+\_\+mean }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Run a simulation, modify the sequences, and output results to file. 

output\+: where we write to disc pm\+: the point mutator we use in our simulation init\+\_\+seqs\+: the initial sequences we start with recomb\+\_\+mean\+: the expected number of template switches 

Reimplemented in \mbox{\hyperlink{classrcombinator_1_1EvolutionWithoutFlags_a9e27b532826998a88d2c157daf53c447}{rcombinator\+::\+Evolution\+Without\+Flags}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classrcombinator_1_1Evolution_a0b8a181242ea8ee3072258fa7ed416f4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classrcombinator_1_1Evolution_a0b8a181242ea8ee3072258fa7ed416f4_icgraph}
\end{center}
\end{figure}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classrcombinator_1_1Evolution_a32a114f62cd6b0f075b8dc47fe86514e}\label{classrcombinator_1_1Evolution_a32a114f62cd6b0f075b8dc47fe86514e}} 
\index{rcombinator\+::\+Evolution@{rcombinator\+::\+Evolution}!families@{families}}
\index{families@{families}!rcombinator\+::\+Evolution@{rcombinator\+::\+Evolution}}
\subsubsection{\texorpdfstring{families}{families}}
{\footnotesize\ttfamily std\+::list$<$\mbox{\hyperlink{classrcombinator_1_1Family}{Family}}$>$ rcombinator\+::\+Evolution\+::families\hspace{0.3cm}{\ttfamily [protected]}}



The actual values of the sequences during the simulation. 

All sequences in family {\itshape i} are present in families\mbox{[}i\mbox{]}. N\+O\+TE\+: Needs to be list so that iterators are valid after insertion/deletion of families. 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/evolution.\+h\item 
src/evolution.\+cpp\end{DoxyCompactItemize}
